<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SEKAI DOTA BOOST - Monte seu Boost</title>
<style>
:root{
  --bg-top:#7dd3fc;
  --bg-bottom:#6d28d9;
  --card:#0f1117;
  --card-soft:#141824;
  --primary:#8b5cf6;
  --text:#f3f4f6;
  --muted:#c4aeca;
  --danger:#ef4444;
  --success:#22c55e;
}
*{box-sizing:border-box;font-family:Arial, Helvetica, sans-serif}
body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(180deg,var(--bg-top),var(--bg-bottom));
  color:var(--text);
}
.wrap{width:100%; max-width:1020px; padding:18px;}
.header{text-align:center;margin-bottom:14px;}
h1{
  margin:0;
  color:#000000; /* cor nova */
  letter-spacing:.5px;
}

.sub{
  margin-top:6px;
  color:#2c1938; /* cor nova */
  font-size:14px;
}

.grid{display:grid;grid-template-columns:1fr;gap:14px;}
@media(min-width:980px){.grid{grid-template-columns:1fr 1fr;}}
.card{
  background:var(--card);
  border-radius:18px;
  padding:18px;
  box-shadow:0 20px 45px rgba(0,0,0,.42);
}
.card h2{
  margin:0;
  font-size:16px;
  color:var(--muted);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.pill{
  font-size:12px;
  padding:6px 10px;
  border-radius:999px;
  background:rgba(139,92,246,.18);
  color:var(--muted);
  border:1px solid rgba(196,181,253,.25);
}
label{display:block;margin-top:10px;margin-bottom:6px;font-size:13px}
input[type=number], input[type=text]{
  width:100%;
  padding:11px 12px;
  border-radius:12px;
  border:1px solid #2a2f45;
  background:var(--card-soft);
  color:var(--text);
}
.two{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.check{display:flex;gap:8px;align-items:center;margin-top:10px;font-size:13px}
small.muted{color:var(--muted)}
.result{
  margin-top:12px;
  padding:12px;
  border-radius:12px;
  background:var(--card-soft);
  min-height:62px;
  font-size:13px;
}
.alert{margin-top:8px;color:var(--danger);font-size:13px}
.ok{color:var(--success)}
details{margin-top:10px;color:var(--muted);font-size:13px}
summary{cursor:pointer}
.big{grid-column:1 / -1;}
button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  background:var(--primary);
  color:white;
  font-size:16px;
  cursor:pointer;
}
button:disabled{opacity:.55;cursor:not-allowed;}
.footer{text-align:center;margin-top:12px;color:var(--muted);font-size:12px}
.badge{display:none;margin-top:8px;font-size:12px;color:var(--success)}
/* collapsible sections */
.serviceBody{display:none;margin-top:10px}
.serviceBody.active{display:block}
/* promo price formatting */
.oldPrice{color:var(--danger);text-decoration:line-through;font-weight:700}
.newPrice{color:var(--success);font-weight:800}
.promoTag{display:inline-block;margin-left:8px;color:var(--success);font-weight:700;font-size:12px}
.hr{height:1px;background:rgba(196,181,253,.18);margin:12px 0;border-radius:999px}

.floating-total{
  position:fixed;
  right:20px;
  bottom:20px;
  background:#0f1117;
  border:1px solid rgba(139,92,246,.4);
  box-shadow:0 15px 35px rgba(0,0,0,.5);
  border-radius:16px;
  padding:14px 16px;
  min-width:200px;
  z-index:9999;
  transition:all .25s ease;
}

.floating-total.hidden{
  opacity:0;
  pointer-events:none;
  transform:translateY(10px);
}

.ft-title{
  font-size:12px;
  color:var(--muted);
  margin-bottom:6px;
}

.ft-price{
  font-size:18px;
  font-weight:800;
  color:var(--success);
}

.ft-discount{
  font-size:12px;
  margin-top:4px;
  color:#facc15;
}

</style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <h1>SEKAI DOTA BOOST</h1>
    <div class="sub"><strong>Monte seu Boost</strong> ‚Ä¢ Calcule cada servi√ßo e veja o total do pacote</div>
  </div>

  <div class="grid">
    <!-- Boost Tradicional -->
    <div class="card">
      <h2>
        <span>Boost Tradicional</span>
        <span class="pill">‚≠ê Mais contratado</span>
        <span class="pill">
          <label class="check" style="margin:0">
            <input type="checkbox" id="useTrad"> Incluir
          </label>
        </span>
      </h2>

      <div class="serviceBody" id="bodyTrad">
        <div class="two">
          <div>
            <label>MMR Atual</label>
            <input type="number" id="tradAtual" min="0" max="8500" placeholder="Ex: 4000" disabled>
          </div>
          <div>
            <label>MMR Desejado (0 - 8500)</label>
            <input type="number" id="tradDesejado" min="0" max="8500" placeholder="Ex: 4500" disabled>
          </div>
        </div>

        <div class="check">
          <input type="checkbox" id="tradOff" disabled>
          <span>Servi√ßo off-stream? (transmiss√£o na Twitch sekai_oficial)</span>
        </div>
        <small class="muted">Obs.: o c√°lculo de off-stream √© interno e n√£o exibe dias.</small>

        <!-- SAIBA MAIS -->
        <details>
  <summary>Saiba mais sobre o Boost Tradicional</summary>

  <p><strong>üîΩ Abaixo de 4.000 MMR (valor fixo)</strong></p>
  <ul>
    <li>Servi√ßo para contas abaixo de 4.000 MMR</li>
    <li>Pedido m√≠nimo: 500 MMR</li>
    <li>üí∞ Valor: R$ 200,00 a cada 500 MMR</li>
  </ul>

  <p><strong>üîº Acima de 4.000 MMR</strong></p>
  <ul>
    <li>O valor passa a ser calculado de forma personalizada</li>
    <li>Basta informar o MMR atual para c√°lculo exato</li>
  </ul>

  <p><strong>üîÑ Margem de erro</strong></p>
  <ul>
    <li>Ajuste gratuito de at√© ¬±100 MMR</li>
    <li>Acima disso, o valor ser√° recalculado</li>
  </ul>

  <p><strong>üìå Como contratar:</strong><br>
  Utilize nossa calculadora para gerar seu or√ßamento.</p>
</details>


        <div class="result" id="tradRes">Preencha os dados para ver o valor.</div>
        <div class="alert" id="tradAlert"></div>
      </div>
    </div>

    <!-- Double MMR -->
    <div class="card">
      <h2>
        <span>Double MMR</span>
        <span class="pill">‚ö° Mais pr√°tico</span>
        <span class="pill">
          <label class="check" style="margin:0">
            <input type="checkbox" id="useDouble"> Incluir
          </label>
        </span>
      </h2>

      <div class="serviceBody" id="bodyDouble">
        <label>MMR Atual</label>
        <input type="number" id="doubleMMR" min="0" placeholder="Ex: 3200" disabled>

        <label>Dias contratados (1 a 7)</label>
        <input type="number" id="doubleDays" min="1" max="7" value="1" disabled>

        <div class="check">
          <input type="checkbox" id="doubleOff" disabled>
          <span>Double MMR Off stream (+ R$20,00) na Twitch sekai_oficial</span>
        </div>

        <!-- SAIBA MAIS -->
        <details>
  <summary>Saiba mais sobre o Double MMR</summary>

  <p><strong>üé¥ Parte 1 ‚Äî Di√°ria de Fichas</strong></p>
  <ul>
    <li>Pacotes de 7 partidas (Double Down) por dia</li>
    <li>üí∞ Pre√ßo base: R$ 70,00 por di√°ria (varia conforme MMR)</li>
  </ul>

  <p><strong>‚ö†Ô∏è Regra importante</strong></p>
  <p>
    Se durante o servi√ßo o MMR ultrapassar 4.000,
    as novas di√°rias passam a custar R$ 122,50.
    As di√°rias j√° pagas mant√™m o valor antigo.
  </p>

  <p><strong>üí° Exemplo:</strong><br>
    MMR 2100 ‚Üí 6 di√°rias = R$ 70 √ó 6 = R$ 420<br>
    Ao subir para 4.000+, novas di√°rias = R$ 122,50
  </p>

  <p><strong>üé¥ Parte 2 ‚Äî Faixa 4.000 a 5.000</strong></p>
  <ul>
    <li>Pre√ßo: R$ 122,50 por di√°ria</li>
    <li>Pode haver limita√ß√£o de di√°rias por compra</li>
  </ul>
</details>

<div class="result" id="doubleRes">Selecione as op√ß√µes para ver o valor.</div>
<div class="alert" id="doubleAlert"></div>
      </div>
    </div>

    
    <!-- Boost Casual -->
    <div class="card">
      <h2>
        <span>Boost Casual</span>
        <span class="pill">üí∞ Melhor custo-benef√≠cio</span>
        <span class="pill">
          <label class="check" style="margin:0">
            <input type="checkbox" id="useCasual"> Incluir
          </label>
        </span>
      </h2>

      <div class="serviceBody" id="bodyCasual">
        <label>Quantos dias de servi√ßo? (1 a 30)</label>
        <input type="number" id="casualDays" min="1" max="30" value="1" disabled>

        <div class="check">
          <input type="checkbox" id="casualOff" disabled>
          <span>Jogar Off Stream (<span style="color:var(--danger);text-decoration:line-through;">R$ 20,00</span> ‚Üí <span style="color:var(--success);">R$ 15,00</span> por dia) na Twitch sekai_oficial</span>
        </div>

        <!-- SAIBA MAIS -->
        <details>
  <summary>Saiba mais sobre o Boost Casual</summary>

  <ul>
    <li>üéÆ 7 partidas por dia</li>
    <li>‚ùå N√£o garantimos vit√≥rias</li>
    <li>üéØ Her√≥is escolhidos conforme necessidade</li>
    <li>üí∞ R$ 85,00 por dia</li>
  </ul>

  <p><strong>üì¶ Entrega da conta</strong></p>
  <ul>
    <li>Conta entregue 1 dia antes</li>
    <li>Nenhuma partida √© jogada nesse per√≠odo</li>
  </ul>

  <p><strong>üìå Regras</strong></p>
  <ul>
    <li>‚úî At√© 6.500 MMR</li>
    <li>‚ùå Acima disso n√£o aceitamos</li>
    <li>‚úî 8.000+ de Behavior Score</li>
  </ul>
</details>


        <div class="result" id="casualRes">Preencha os dados para ver o valor.</div>
        <div class="alert" id="casualAlert"></div>
        <div class="badge" id="comboBadge">‚úÖ Combo ativo: Boost Casual (1 dia) + 2 Replays (1 dia) ‚Üí total do combo = R$ 155,00</div>
      </div>
    </div>

    <!-- Recalibra√ß√£o -->
    <div class="card">
      <h2>
        <span>Recalibra√ß√£o</span>
        <span class="pill">üîÑ recomendado</span>

        <span class="pill">
          <label class="check" style="margin:0">
            <input type="checkbox" id="useRecal"> Incluir
          </label>
        </span>
      </h2>

      <div class="serviceBody" id="bodyRecal">
        <label>Nome</label>
        <input type="text" id="recalNome" placeholder="Seu nome" disabled>

        <label>MMR Atual</label>
        <input type="number" id="recalMMR" min="0" placeholder="Ex: 3500" disabled>

        <div class="check">
          <input type="checkbox" id="recalOff" disabled>
          <span>Off stream (+ R$40 fixo) na Twitch sekai_oficial</span>
        </div>

        <!-- SAIBA MAIS -->
        <details>
  <summary>Saiba mais sobre a Recalibra√ß√£o</summary>

  <p><strong>üîÑ Recalibra√ß√£o Simples</strong></p>
  <ul>
    <li>15 a 16 partidas</li>
    <li>Poss√≠vel ganho m√©dio entre 700 e 1100 MMR</li>
    <li>Indicada para contas entre 0 e 4.000 MMR</li>
  </ul>

  <p><strong>üîÑ Recalibra√ß√£o Avan√ßada</strong></p>
  <ul>
    <li>Mesma quantidade de partidas</li>
    <li>Indicada para contas entre 4.000 e 6.000 MMR</li>
    <li>Resultado pode variar conforme a conta</li>
  </ul>

  <p><strong>‚ö†Ô∏è N√£o h√° garantia de MMR final.</strong></p>
</details>


        <div class="result" id="recalRes">Preencha os dados para ver o valor.</div>
        <div class="alert" id="recalAlert"></div>
      </div>
    </div>

    <!-- Replay -->
    <div class="card">
      <h2>
        <span>An√°lise de Replay</span>
        <span class="pill">üìä Educativo</span>
        <span class="pill">
          <label class="check" style="margin:0">
            <input type="checkbox" id="useReplay"> Incluir
          </label>
        </span>
      </h2>

      <div class="serviceBody" id="bodyReplay">
        <label>Quantidade de an√°lises</label>
        <input type="number" id="repQtd" min="1" value="1" disabled>

        <label>Em quantos dias deseja dividir?</label>
        <input type="number" id="repDias" min="1" value="1" disabled>

        <div class="check">
          <input type="checkbox" id="repOff" disabled>
          <span>An√°lise Off Stream</span>
        </div>

        <!-- SAIBA MAIS -->
        <details>
  <summary>Saiba mais sobre a An√°lise de Replay</summary>

  <ul>
    <li>An√°lise t√©cnica focada em evolu√ß√£o</li>
    <li>Realizada via Discord ou Live</li>
    <li>Dura√ß√£o m√°xima: 1 hora por an√°lise</li>
  </ul>

  <p><strong>üí∞ Taxa Off Stream</strong></p>
  <ul>
    <li>R$ 10,00 por dia ‚Üí at√© 3 an√°lises</li>
    <li>R$ 20,00 por dia ‚Üí acima disso</li>
  </ul>

  <p><strong>üìå Regras</strong></p>
  <ul>
    <li>‚úî Pagamento antecipado</li>
    <li>‚úî Datas combinadas via WhatsApp</li>
    <li>‚úî Desconto apenas em dias com 2 a 3 an√°lises</li>
    <li>‚úî M√°ximo de 6 an√°lises por dia</li>
  </ul>
</details>


        <div class="result" id="repRes">Preencha os dados para ver o valor.</div>
        <div class="alert" id="repAlert"></div>
      </div>
    </div>

    <!-- Coach -->
    <div class="card">
      <h2>
        <span>Coach</span>
        <span class="pill">üéì Evolu√ß√£o real</span>
        <span class="pill">
          <label class="check" style="margin:0">
            <input type="checkbox" id="useCoach"> Incluir
          </label>
        </span>
      </h2>

      <div class="serviceBody" id="bodyCoach">
        <div class="check">
          <input type="checkbox" id="coachP1" disabled>
          <span>Coach Parte 1 ‚Äî R$ 200,00</span>
        </div>
        <div class="check">
          <input type="checkbox" id="coachP2" disabled>
          <span>Coach Parte 2 ‚Äî R$ 200,00</span>
        </div>

        <!-- SAIBA MAIS -->
    <details>
      <summary>üéì Saber mais sobre o Coach</summary>

      <p>
        Voc√™ pode marcar dia e hor√°rio de sua prefer√™ncia, com no m√≠nimo
        <strong>1 dia de anteced√™ncia</strong>, sujeito √† disponibilidade
        de ambas as partes.
      </p>

      <p><strong>üìö Parte 1 ‚Äî Aula Demonstrativa</strong></p>
      <ul>
        <li>Eu jogo 4 partidas na sua conta</li>
        <li>Voc√™ escolhe 4 her√≥is</li>
        <li>Explica√ß√£o passo a passo das decis√µes</li>
        <li>Comunica√ß√£o via Discord em tempo real</li>
        <li>Foco em mapa, leitura de jogo e tomadas de decis√£o</li>
      </ul>

      <p><strong>üìö Parte 2 ‚Äî Voc√™ joga, eu guio</strong></p>
      <ul>
        <li>Voc√™ joga com os mesmos her√≥is escolhidos</li>
        <li>Eu acompanho e guio suas decis√µes</li>
        <li>Objetivo: te tornar independente para vencer sozinho depois</li>
      </ul>
    </details>

        <div class="result" id="coachRes">Selecione as op√ß√µes para ver o valor.</div>
        <div class="alert" id="coachAlert"></div>
      </div>
    </div>

    <!-- Informa√ß√µes de desconto -->
    <div class="card big">
      <h2><span>Informa√ß√µes de desconto</span><span class="pill">Combos</span></h2>
      <div style="color:var(--muted);font-size:13px;line-height:1.45">
        ‚Ä¢ <strong>Combo:</strong> Boost Casual (1 dia) + 2 An√°lises de Replay (1 dia) ‚Üí <strong>R$ 155,00</strong><br>
        ‚Ä¢ <strong>Combo:</strong> Ao contratar Boost Tradicional (m√≠nimo de R$ 200) + coach parte 1 voc√™ recebe <strong>50% OFF na Parte 2 do Coach</strong>.<br>
        ‚Ä¢ <strong>Promo√ß√£o:</strong> Ao contratar <strong>2 ou mais servi√ßos de boost</strong> no mesmo pacote, a taxa off stream dos boosts fica <strong>R$ 15,00 por dia</strong> (em vez de R$ 20,00).<br>
        <div class="hr"></div>
        <small class="muted">Obs.: Cada servi√ßo tem c√°lculo pr√≥prio. O total final soma tudo e aplica as promo√ß√µes acima automaticamente.</small>
      </div>
    </div>

    <!-- Total -->
    <div class="card big">
      <h2><span>Resumo do pacote</span><span class="pill">Total final</span></h2>

      <div class="result" id="totalRes">Selecione servi√ßos para ver o total.</div>
      <div class="alert" id="totalAlert"></div>

      <div class="check">
        <input type="checkbox" id="globalBS">
        <span>Possuo mais de 8k de Behavior Score</span>
      </div>

      <div class="check">
        <input type="checkbox" id="packTerms">
        <span>Li e concordo que o pagamento √© necess√°rio para garantir minha vaga e que datas exatas devem ser combinadas via WhatsApp.</span>
      </div>

      <button id="zapBtn" disabled>Contratar pacote via WhatsApp</button>
      <div class="footer">Twitch: sekai_oficial ‚Ä¢ WhatsApp: +55 21 99184-4917</div>
    </div>
  </div>
</div>

<script>
/* ========= helpers ========= */
const $ = (id) => document.getElementById(id);
const money = (n) => "R$ " + n.toFixed(2).replace(".", ",");
const clampInt = (v, min, max) => (isNaN(v) ? null : Math.min(Math.max(v, min), max));

/* collapse/expand service bodies */
function syncBodies(){
  const pairs = [
    ["useTrad","bodyTrad"],
    ["useDouble","bodyDouble"],
    ["useCasual","bodyCasual"],
    ["useRecal","bodyRecal"],
    ["useReplay","bodyReplay"],
    ["useCoach","bodyCoach"],
  ];
  pairs.forEach(([chk, body]) => {
    $(body).classList.toggle("active", $(chk).checked);
  });
}

function enableGroup(useId, fields){
  const on = $(useId).checked;
  fields.forEach(f => $(f).disabled = !on);
}

function countBoostSelected(){
  return ["useTrad","useDouble","useCasual"].filter(id => $(id).checked).length;
}
function offBoostPerDay(){
  // Promo: se 2+ boosts selecionados, off-stream nos boosts fica 15 (ao inv√©s de 20)
  return (countBoostSelected() >= 2) ? 15 : 20;
}

/* ========= Boost Tradicional (CORRIGIDO) ========= */

// c√°lculo progressivo por faixa
function calcTradBaseProgressivo(mmrAtual, mmrDesejado){
  const TABELA_PRECOS = [
    { min: 0,    max: 4000, preco: 0.40 },
    { min: 4001, max: 4500, preco: 0.65 },
    { min: 4501, max: 5000, preco: 0.75 },
    { min: 5001, max: 5500, preco: 1.10 },
    { min: 5501, max: 6000, preco: 2.10 },
    { min: 6001, max: 6500, preco: 3.20 },
    { min: 6501, max: 7000, preco: 3.80 },
    { min: 7001, max: 7500, preco: 4.75 },
    { min: 7501, max: 8000, preco: 7.60 },
    { min: 8001, max: 8500, preco: 8.50 }
  ];

  let precoTotal = 0;
  let mmrAtualTemp = mmrAtual;

  for (const faixa of TABELA_PRECOS) {
    if (mmrAtualTemp < mmrDesejado && mmrAtualTemp <= faixa.max) {
      const inicioEfetivo = Math.max(mmrAtualTemp, faixa.min);
      const fimEfetivo = Math.min(mmrDesejado, faixa.max);
      const mmrNaFaixa = fimEfetivo - inicioEfetivo;

      if (mmrNaFaixa > 0) {
        precoTotal += mmrNaFaixa * faixa.preco;
        mmrAtualTemp = fimEfetivo;
      }

      if (mmrAtualTemp >= mmrDesejado) break;
    }
  }

  return precoTotal;
}


function tradDiscountPct(mmrAtual, delta){
  // Descontos s√≥ para MMR inicial ‚â• 4000
  if(mmrAtual < 4000) return 0;

  if(delta >= 1500) return 0.12;
  if(delta >= 1250) return 0.10;
  if(delta >= 1000) return 0.08;
  if(delta >= 750)  return 0.06;
  if(delta >= 500)  return 0.04;
  return 0;
}


function calcTrad(perDayOff){
  if(!$("useTrad").checked){
    $("tradRes").innerHTML = "Preencha os dados para ver o valor.";
    $("tradAlert").textContent = "";
    return { selected:false, ok:true, total:0, totalNoPromo:0, tradSpend:0, text:"" };
  }

  const atual = clampInt(Number($("tradAtual").value), 0, 8500);
  const des   = clampInt(Number($("tradDesejado").value), 0, 8500);
  const off   = $("tradOff").checked;

  $("tradAlert").textContent = "";

  if(atual === null || des === null){
    $("tradRes").innerHTML = "Preencha MMR atual e desejado.";
    return { selected:true, ok:false, total:0, totalNoPromo:0, tradSpend:0, text:"Boost Tradicional inv√°lido" };
  }

  if(des <= atual){
    $("tradRes").innerHTML = "<strong>Pre√ßo: INV√ÅLIDO</strong>";
    $("tradAlert").textContent = "üî¥ O MMR desejado deve ser maior que o atual.";
    return { selected:true, ok:false, total:0, totalNoPromo:0, tradSpend:0, text:"Boost Tradicional inv√°lido" };
  }

  let delta = des - atual;

// m√≠nimo de 500 MMR apenas se atual < 4000
if(atual < 4000 && delta < 500){
  delta = 500;
  $("tradAlert").textContent =
    "‚ö†Ô∏è Pedido m√≠nimo para contas abaixo de 4.000 MMR √© 500 MMR (ajustado automaticamente).";
}


  // ‚úÖ BASE CORRETA (progressiva)
  const base = calcTradBaseProgressivo(atual, des);

  // desconto
  const pct = tradDiscountPct(atual, delta);
  const baseAfter = base - (base * pct);

  // off-stream
  let offFee = 0;
  if(off){
    const dias = Math.max(1, Math.floor(delta / 150));
    offFee = dias * perDayOff;
  }

  const totalFinal = baseAfter + offFee;
  const totalSemDesconto = base + offFee;

  $("tradRes").innerHTML =
    `<strong>Delta considerado:</strong> ${delta} MMR<br>
     <strong>C√°lculo:</strong> Progressivo por faixa<br>
     <strong>Base:</strong> ${money(base)}
       ${pct > 0 ? `<span class="ok"> (${Math.round(pct*100)}% OFF)</span>` : ""}<br>
     <strong>Off-stream:</strong> ${off ? money(offFee) : money(0)}<br>
     <strong>Total:</strong> ${money(totalFinal)}`;

  return {
    selected: true,
    ok: true,

    total: totalFinal,
    totalNoPromo: totalSemDesconto,
    tradSpend: totalFinal,

    text:
      pct > 0
        ? `Boost Tradicional: +${delta} MMR | ${money(totalSemDesconto)} ‚Üí ${money(totalFinal)} (${Math.round(pct*100)}% OFF)`
        : `Boost Tradicional: +${delta} MMR | Total: ${money(totalFinal)}`,

    details:
`üÜô BOOST TRADICIONAL
‚Ä¢ MMR atual: ${atual}
‚Ä¢ MMR desejado: ${des}
‚Ä¢ Quantidade: ${delta} MMR
‚Ä¢ Valor base: ${money(base)}
‚Ä¢ Desconto: ${pct > 0 ? Math.round(pct*100) + "% OFF" : "Nenhum"}
‚Ä¢ Off-stream: ${off ? money(offFee) : "N√£o"}
‚Ä¢ Total: ${money(totalFinal)}`
  };
}

/* ========= Double MMR ========= */
function doubleBaseByMMR(mmr){
  if(mmr <= 3999) return 70;
  if(mmr <= 4999) return 122.5;
  if(mmr <= 6000) return 245;
  return null;
}
function calcDouble(perDayOff){
  if(!$("useDouble").checked){
    $("doubleRes").innerHTML = "Preencha os dados para ver o valor.";
    $("doubleAlert").textContent = "";
    return {selected:false, ok:true, total:0, totalNoPromo:0, text:""};
  }

  const mmr = clampInt(Number($("doubleMMR").value), 0, 999999);
  const days = clampInt(Number($("doubleDays").value), 1, 7);
  const off = $("doubleOff").checked;

  $("doubleAlert").innerHTML = "";

  if(mmr === null || days === null){
    $("doubleRes").innerHTML = "Preencha o MMR e os dias.";
    return {selected:true, ok:false, total:0, totalNoPromo:0, text:"Double MMR: dados incompletos"};
  }
  if(mmr >= 6001){
    $("doubleRes").innerHTML = "<strong>Pre√ßo: INV√ÅLIDO</strong>";
    $("doubleAlert").textContent = "üî¥ Esse MMR n√£o √© compat√≠vel com este servi√ßo.";
    return {selected:true, ok:false, total:0, totalNoPromo:0, text:"Double MMR: inv√°lido"};
  }

  let totalBase = 0;
  let cur = mmr;
  for(let i=0;i<days;i++){
    const b = doubleBaseByMMR(cur);
    if(b === null){
      $("doubleRes").innerHTML = "<strong>Pre√ßo: INV√ÅLIDO</strong>";
      $("doubleAlert").textContent = "üî¥ Esse MMR n√£o √© compat√≠vel com este servi√ßo.";
      return {selected:true, ok:false, total:0, totalNoPromo:0, text:"Double MMR: inv√°lido"};
    }
    totalBase += b;
    cur += 150;
  }

  const offFee = off ? (days * 20) : 0;


  const total = totalBase + offFee;
const totalNoPromo = total;

  $("doubleRes").innerHTML =
    `<strong>Dias:</strong> ${days}<br>
     <strong>Off-stream:</strong> ${off ? money(offFee) + " (R$ 20,00 por dia)" : money(0)}<br>
     <strong>Total:</strong> ${money(total)}`;

  return {
  selected:true,
  ok:true,
  total,
  totalNoPromo,
  text:`Double MMR: ${days} dia(s) | Total: ${money(total)}`,
  details:
`‚ö° DOUBLE MMR
‚Ä¢ MMR atual: ${mmr}
‚Ä¢ Dias contratados: ${days}
‚Ä¢ Valor base: ${money(totalBase)}
‚Ä¢ Off-stream: ${off ? money(offFee) + " (R$ 20,00 por dia)" : "N√£o"}
‚Ä¢ Total: ${money(total)}`
};

}

/* ========= Boost Casual ========= */
function calcCasual(){
  if(!$("useCasual").checked){
    $("casualRes").innerHTML = "Preencha os dados para ver o valor.";
    $("casualAlert").textContent = "";
    $("comboBadge").style.display = "none";
    return {selected:false, ok:true, total:0, totalNoPromo:0, text:"", days:null};
  }

  const days = clampInt(Number($("casualDays").value), 1, 30);
  const off = $("casualOff").checked;

  $("casualAlert").textContent = "";

  if(days === null){
    $("casualRes").innerHTML = "Selecione os dias (1 a 30).";
    return {selected:true, ok:false, total:0, totalNoPromo:0, text:"Boost Casual: dados incompletos", days:null};
  }

  const base = days * 85;
  const offFeePromo = off ? (days * 15) : 0; // casual mant√©m 15 (promo fixa do servi√ßo)
  const offFeeNoPromo = off ? (days * 15) : 0;

  const total = base + offFeePromo;
  const totalNoPromo = base + offFeeNoPromo;

  const jogos = days * 7;

  $("casualRes").innerHTML =
    `<strong>Jogos totais:</strong> ${jogos}<br>
     <strong>Base:</strong> ${money(base)}<br>
     <strong>Off-stream:</strong> ${off ? money(offFeePromo) : money(0)}<br>
     <strong>Total:</strong> ${money(total)}`;

  return {
  selected:true,
  ok:true,
  total,
  totalNoPromo,
  days,
  text:`Boost Casual: ${days} dia(s) | Total: ${money(total)}`,
  details:
`üí∞ BOOST CASUAL
‚Ä¢ Dias contratados: ${days}
‚Ä¢ Total de partidas: ${jogos}
‚Ä¢ Valor base: ${money(base)}
‚Ä¢ Off-stream: ${off ? money(offFeePromo) : "N√£o"}
‚Ä¢ Total: ${money(total)}`
};

}

/* ========= Recalibra√ß√£o ========= */
function calcRecal(){
  if(!$("useRecal").checked){
    $("recalRes").innerHTML = "Preencha os dados para ver o valor.";
    $("recalAlert").textContent = "";
    return {selected:false, ok:true, total:0, totalNoPromo:0, text:""};
  }

  const nome = ($("recalNome").value || "N√£o informado").trim();
  const mmr = clampInt(Number($("recalMMR").value), 0, 999999);
  const off = $("recalOff").checked;

  $("recalAlert").innerHTML = "";

  if(mmr === null){
    $("recalRes").innerHTML = "Digite o MMR para calcular.";
    return {selected:true, ok:false, total:0, totalNoPromo:0, text:"Recalibra√ß√£o: dados incompletos"};
  }

  let base = null;
  if(mmr <= 4000) base = 200;
  else if(mmr <= 6000) base = 250;

  if(base === null){
    $("recalRes").innerHTML = "<strong>Pre√ßo: INV√ÅLIDO</strong>";
    $("recalAlert").textContent = "üö´ Esse MMR n√£o √© compat√≠vel com este servi√ßo.";
    return {selected:true, ok:false, total:0, totalNoPromo:0, text:"Recalibra√ß√£o: inv√°lido"};
  }

  const total = base + (off ? 40 : 0);
  const totalNoPromo = total;

  $("recalRes").innerHTML =
    `<strong>Base:</strong> ${money(base)}<br>
     <strong>Off-stream:</strong> ${off ? money(40) : money(0)}<br>
     <strong>Total:</strong> ${money(total)}`;

  return {
  selected:true,
  ok:true,
  total,
  totalNoPromo,
  text:`Recalibra√ß√£o: ${nome} | Total: ${money(total)}`,
  details:
`üîÑ RECALIBRA√á√ÉO
‚Ä¢ Nome: ${nome}
‚Ä¢ MMR atual: ${mmr}
‚Ä¢ Off-stream: ${off ? "Sim (+R$40)" : "N√£o"}
‚Ä¢ Total: ${money(total)}`
};

}

/* ========= Replay ========= */
function calcReplay(){
  if(!$("useReplay").checked){
    $("repRes").innerHTML = "Preencha os dados para ver o valor.";
    $("repAlert").textContent = "";
    return {selected:false, ok:true, total:0, totalNoPromo:0, text:"", qtd:null, dias:null};
  }

  const qtd = clampInt(Number($("repQtd").value), 1, 999999);
  const dias = clampInt(Number($("repDias").value), 1, 999999);
  const off = $("repOff").checked;

  $("repAlert").textContent = "";

  if(qtd === null || dias === null){
    $("repRes").innerHTML = "Preencha quantidade e dias.";
    return {selected:true, ok:false, total:0, totalNoPromo:0, text:"Replay: dados incompletos", qtd:null, dias:null};
  }

  let base = Math.floor(qtd / dias);
  let sobra = qtd % dias;

  let totalAnalises = 0;
  let taxaOff = 0;
  let lines = [];

  for(let d=1; d<=dias; d++){
    let hoje = base + (sobra > 0 ? 1 : 0);
    if(sobra > 0) sobra--;

    if(hoje > 6){
      $("repRes").innerHTML = "<strong>Pre√ßo: INV√ÅLIDO</strong>";
      $("repAlert").textContent = "üî¥ Esse servi√ßo ultrapassou o limite de an√°lises em um √∫nico dia.";
      return {selected:true, ok:false, total:0, totalNoPromo:0, text:"Replay: inv√°lido", qtd, dias};
    }

    let precoUnit = 50;
    let desconto = false;
    if(hoje >= 2 && hoje <= 3){ precoUnit = 40; desconto = true; }
    totalAnalises += hoje * precoUnit;

    if(off){
      taxaOff += (hoje <= 3 ? 10 : 20);
    }

    lines.push(desconto ? `Dia ${d} = ${hoje} an√°lise(s) <span class="ok">(desconto aplicado)</span>` : `Dia ${d} = ${hoje} an√°lise(s)`);
  }

  const total = totalAnalises + taxaOff;
  const totalNoPromo = total;

  $("repRes").innerHTML =
    `<strong>üìä Distribui√ß√£o:</strong><br>${lines.join("<br>")}<br><br>
     <strong>Valor das an√°lises:</strong> ${money(totalAnalises)}<br>
     <strong>Taxa off stream:</strong> ${money(taxaOff)}<br>
     <strong>Total:</strong> ${money(total)}`;

  return {
  selected:true,
  ok:true,
  total,
  totalNoPromo,
  qtd,
  dias,
  text:`Replay: ${qtd} an√°lise(s) | Total: ${money(total)}`,
  details:
`üìä AN√ÅLISE DE REPLAY
‚Ä¢ Quantidade de an√°lises: ${qtd}
‚Ä¢ Dias: ${dias}
‚Ä¢ Valor an√°lises: ${money(totalAnalises)}
‚Ä¢ Off-stream: ${money(taxaOff)}
‚Ä¢ Total: ${money(total)}`
};

}

/* ========= Coach ========= */
function calcCoach(tradEligible){
  if(!$("useCoach").checked){
    $("coachRes").innerHTML = "Selecione as op√ß√µes para ver o valor.";
    $("coachAlert").textContent = "";
    return {selected:false, ok:true, total:0, totalNoPromo:0, text:"", coachDiscount:0};
  }

  const p1 = $("coachP1").checked;
  const p2 = $("coachP2").checked;

  $("coachAlert").textContent = "";

  if(p2 && !p1){
    $("coachAlert").textContent =
      "‚ö†Ô∏è Para obter desconto na Parte 2, √© necess√°rio contratar a Parte 1.";
  }

  let base = 0;
  if(p1) base += 200;
  if(p2) base += 200;

  // desconto: 50% na parte 2 se Boost Tradicional >= R$200
  let disc = 0;
  if(p1 && p2 && tradEligible){
    disc = 100;
  }

  const total = base - disc;
  const totalNoPromo = base;

  $("coachAlert").textContent =
    disc > 0 ? "‚úÖ Promo√ß√£o: 50% OFF aplicado na Parte 2 do Coach." : "";

  $("coachRes").innerHTML =
    `<strong>Base:</strong> ${money(base)}<br>
     <strong>Desconto:</strong> ${disc>0 ? ("- " + money(disc)) : money(0)}<br>
     <strong>Total:</strong> ${money(total)}`;

  return {
    selected:true,
    ok:true,
    total,
    totalNoPromo,
    text:`Coach | Total: ${money(total)}`,
    details:
`üéì COACH
‚Ä¢ Parte 1: ${p1 ? "Sim" : "N√£o"}
‚Ä¢ Parte 2: ${p2 ? "Sim" : "N√£o"}
‚Ä¢ Desconto aplicado: ${disc > 0 ? money(disc) : "Nenhum"}
‚Ä¢ Total: ${money(total)}`
  };
}


/* ========= Combo controlado ========= */
function comboCasualReplay(cas, rep){
  // Regra: 1 dia casual + 2 replays em 1 dia => total fixo do combo = 155
  if(cas.selected && cas.ok && rep.selected && rep.ok){
    if(cas.days === 1 && rep.qtd === 2 && rep.dias === 1){
      const normal = cas.total + rep.total;
      return {active:true, delta:(155 - normal)};
    }
  }
  return {active:false, delta:0};
}

/* ========= update all ========= */
function updateAll(){
  syncBodies();

  enableGroup("useTrad",   ["tradAtual","tradDesejado","tradOff"]);
  enableGroup("useDouble", ["doubleMMR","doubleDays","doubleOff"]);
  enableGroup("useCasual", ["casualDays","casualOff"]);
  enableGroup("useRecal",  ["recalNome","recalMMR","recalOff"]);
  enableGroup("useReplay", ["repQtd","repDias","repOff"]);
  enableGroup("useCoach",  ["coachP1","coachP2"]);

  const perDayOff = offBoostPerDay();

  const trad = calcTrad(perDayOff);
  const dbl  = calcDouble(perDayOff);
  const cas  = calcCasual();
  const rec  = calcRecal();
  const rep  = calcReplay();

  // trad eligibility for coach discount: trad selected, ok, and spend >= 200
  const tradEligible = trad.selected && trad.ok && trad.tradSpend >= 200;

  const coach = calcCoach(tradEligible);

  const selectedAny = [trad,dbl,cas,rec,rep,coach].some(x => x.selected);
  const packTerms = $("packTerms").checked;
  const bs = $("globalBS").checked;

  let total = 0;
  let totalNoPromo = 0;
  let items = [];
  let invalid = [];

  [trad,dbl,cas,rec,rep,coach].forEach(obj => {
    if(obj.selected){
      if(!obj.ok){
        invalid.push("‚ö†Ô∏è Corrija os dados de um dos servi√ßos selecionados.");
      }else{
        total += obj.total;
        totalNoPromo += obj.totalNoPromo;
        items.push("‚Ä¢ " + obj.text);
      }
    }
  });
  // ===== calcula porcentagem de desconto total =====


  // apply combo casual+replay
  const combo = comboCasualReplay(cas, rep);
  if(combo.active){
    $("comboBadge").style.display = "block";
    total += combo.delta;
    // totalNoPromo n√£o muda aqui (mant√©m sem combo)
    items.push("‚Ä¢ Promo√ß√£o combo: Boost Casual (1 dia) + 2 Replays (1 dia) ‚Üí R$ 155,00");
  } else {
    $("comboBadge").style.display = "none";
  }
  
// ===== calcula porcentagem de desconto FINAL =====
let discountPct = 0;
if(totalNoPromo > total){
  discountPct = Math.round(
    ((totalNoPromo - total) / totalNoPromo) * 100
  );
}


  // total UI
  if(!selectedAny){
    $("totalRes").innerHTML = "Selecione servi√ßos para ver o total.";
    $("totalAlert").textContent = "";
    $("zapBtn").disabled = true;
    return;
  }

  // price highlight if promo differs
const hasPromo = Math.abs(totalNoPromo - total) > 0.009;

const priceLine = hasPromo
  ? `<div style="margin-top:6px">
       <span class="oldPrice">${money(totalNoPromo)}</span>
       <span style="margin:0 8px;color:var(--muted)">‚Üí</span>
       <span class="newPrice">${money(total)}</span>
       <span class="promoTag">üî• ${discountPct}% OFF</span>
     </div>`
  : `<div style="margin-top:6px">
       <span class="newPrice">${money(total)}</span>
     </div>`;

  $("totalRes").innerHTML =
    `<strong>Itens selecionados:</strong><br>${items.join("<br>")}<br><br>
     <strong>üíµ Total final:</strong>${priceLine}`;

  let alerts = [];
  if(invalid.length) alerts.push(invalid[0]);
  if(!bs) alerts.push("‚ö†Ô∏è √â necess√°rio possuir mais de 8k de Behavior Score.");
  if(!packTerms) alerts.push("‚ö†Ô∏è √â necess√°rio aceitar os termos do pacote para continuar.");
  $("totalAlert").innerHTML = alerts.join("<br>");

  const canZap = (invalid.length === 0) && packTerms && bs;

// ESSA LINHA √â O QUE FALTAVA üëá
$("zapBtn").disabled = !canZap;

$("zapBtn").onclick = () => {
  let detalhes = [];

  [trad,dbl,cas,rec,rep,coach].forEach(obj => {
    if(obj.selected && obj.ok && obj.details){
      detalhes.push(obj.details);
    }
  });

  const msg = encodeURIComponent(
    "Ol√°! Quero contratar um pacote na *SEKAI DOTA BOOST*.\n\n" +
    detalhes.join("\n\n") +
    "\n\nüíµ TOTAL FINAL: " + money(total) +
    "\n\nObs.: Datas ser√£o combinadas via WhatsApp."
  );

  window.open("https://wa.me/5521991844917?text=" + msg);
};
/* ===== AQUI COME√áA O BAL√ÉO FLUTUANTE ===== */

const floatBox = $("floatingTotal");
const ftPrice  = $("ftPrice");
const ftDisc   = $("ftDiscount");

if(selectedAny){
  floatBox.classList.remove("hidden");

  if(hasPromo){
    ftPrice.innerHTML = `
      <span class="oldPrice" style="font-size:13px">${money(totalNoPromo)}</span><br>
      <span class="newPrice">${money(total)}</span>
    `;
    ftDisc.textContent = `üî• ${discountPct}% OFF aplicado`;
  }else{
    ftPrice.textContent = money(total);
    ftDisc.textContent = "";
  }
}else{
  floatBox.classList.add("hidden");
}
}


[
  "useTrad","useDouble","useCasual","useRecal","useReplay","useCoach",
  "tradAtual","tradDesejado","tradOff",
  "doubleMMR","doubleDays","doubleOff",
  "casualDays","casualOff",
  "recalNome","recalMMR","recalOff",
  "repQtd","repDias","repOff",
  "coachP1","coachP2","coachOff",
  "packTerms","globalBS"
].forEach(id => {
  const el = $(id);
  if(!el) return;
  el.addEventListener(el.type === "checkbox" ? "change" : "input", updateAll);
});

updateAll();

/* ===== CONTROLE DE SCROLL DO BAL√ÉO ===== */
let lastScrollY = window.scrollY;

window.addEventListener("scroll", () => {
  const floatBox = $("floatingTotal");
  if(!floatBox) return;

  const currentY = window.scrollY;

  // Rolando para baixo ‚Üí esconde
  if(currentY > lastScrollY + 10){
    floatBox.classList.add("hidden");
  }

  // Rolando para cima ‚Üí mostra
  if(currentY < lastScrollY - 10){
    floatBox.classList.remove("hidden");
  }

  lastScrollY = currentY;
});
</script>
<!-- Mini carrinho flutuante -->
<div id="floatingTotal" class="floating-total hidden">
  <div class="ft-title">üíº Seu pacote</div>
  <div id="ftPrice" class="ft-price">R$ 0,00</div>
  <div id="ftDiscount" class="ft-discount"></div>
</div>

</body>
</html>
